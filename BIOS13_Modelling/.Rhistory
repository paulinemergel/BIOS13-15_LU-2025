seq[seq=="t"] <- "a"
reverse$x[-i+length(seq)+1] <- seq[i]
}
as.vector(reverse)
return(reverse)
print(reverse)
}
mito_seq_rev <- create_complement(mito_seq)
create_complement <- function(seq){
reverse <- 0
for(i in length(seq):1){ ## use x from function(x) instead of vectorname
seq[seq=="g"] <- "c"
seq[seq=="c"] <- "g"
seq[seq=="a"] <- "u"
seq[seq=="t"] <- "a"
reverse[-i+length(seq)+1] <- seq[i]
}
as.vector(reverse)
return(reverse)
print(reverse)
}
mito_seq_rev <- create_complement(mito_seq)
mito_seq_rev
mito_seq_rev[[1,1]]
mito_seq_rev[[1,]]
mito_seq_rev[[,1]]
mito_seq_rev[1]
mito_seq_rev[1:5]
names(mito_seq_rev) <- c("x")
# OUTPUT
tail(mito_seq_rev$x, 5)
# Comparison
# INPUT
head(mito_seq$x, 5)
# OUTPUT
tail(mito_seq_rev$x, 5)
create_complement <- function(seq){
reverse <- 0
for(i in length(seq):1){ ## use x from function(x) instead of vectorname
seq[seq=="g"] <- "c"
seq[seq=="c"] <- "g"
seq[seq=="a"] <- "t"
seq[seq=="t"] <- "a"
reverse[-i+length(seq)+1] <- seq[i]
}
as.vector(reverse)
return(reverse)
print(reverse)
}
mito_seq_rev <- create_complement(mito_seq)
names(mito_seq_rev) <- c("x")
mito_seq_rev[1:5]
# Comparison
# INPUT
head(mito_seq$x, 5)
# OUTPUT
tail(mito_seq_rev$x, 5)
create_complement <- function(seq){
reverse <- 0
for(i in length(seq):1){ ## use x from function(x) instead of vectorname
seq[seq=="c"] <- "g"
seq[seq=="g"] <- "c"
seq[seq=="t"] <- "a"
seq[seq=="a"] <- "t"
reverse[-i+length(seq)+1] <- seq[i]
}
as.vector(reverse)
return(reverse)
print(reverse)
}
names(mito_seq_rev) <- c("x")
mito_seq_rev[1:5]
# Comparison
# INPUT
head(mito_seq$x, 5)
# OUTPUT
tail(mito_seq_rev$x, 5)
test <- c("g", "a", "t", "c", "a")
test.rev <- create_complement(test)
test.rev
length(test)
test[test=="c"]
create_complement <- function(seq){
reverse <- 0
seq[seq=="c"] <- "g"
seq[seq=="g"] <- "c"
seq[seq=="t"] <- "a"
seq[seq=="a"] <- "t"
for(i in length(seq):1){ ## use x from function(x) instead of vectorname
reverse[-i+length(seq)+1] <- seq[i]
}
as.vector(reverse)
return(reverse)
print(reverse)
}
test <- c("g", "a", "t", "c", "a")
test.rev <- create_complement(test)
length(test)
test.rev
create_complement <- function(seq){
reverse <- 0
seq[seq=="c"] <- "g"
seq[seq=="g"] <- "c"
seq[seq=="t"] <- "a"
seq[seq=="a"] <- "t"
for(i in length(seq):1){ ## use x from function(x) instead of vectorname
reverse[-i+length(seq)+1] <- seq[i]
}
as.vector(reverse)
return(reverse)
print(reverse)
}
test <- c("g", "a", "t", "c", "a")
test.rev <- create_complement(test)
length(test)
test.rev # should be t, g, a, t, c
#length(test)
test.rev # should be t, g, a, t, c
#length(test)
test
create_complement <- function(seq){
reverse <- 0
as.vector(reverse)
seq[seq=="c"] <- "g"
seq[seq=="g"] <- "c"
seq[seq=="t"] <- "a"
seq[seq=="a"] <- "t"
for(i in length(seq):1){ ## use x from function(x) instead of vectorname
reverse[-i+length(seq)+1] <- seq[i]
}
return(reverse)
print(reverse)
}
test <- c("g", "a", "t", "c", "a")
test.rev <- create_complement(test)
test.rev # should be t, g, a, t, c
create_complement <- function(seq){
reverse <- 0
as.vector(reverse)
seq[seq=="c"] <- "g"
seq[seq=="g"] <- "c"
seq[seq=="t"] <- "a"
seq[seq=="a"] <- "t"
print(seq)
}
create_complement(test)
test2 <- create_complement(test)
test2
test
create_complement <- function(seq){
seq[seq=="c"] <- "g"
seq[seq=="g"] <- "c"
seq[seq=="t"] <- "a"
seq[seq=="a"] <- "t"
print(seq)
}
test2 <- create_complement(test)
test2
test
test <- c("g", "a", "t", "c", "a")
create_complement <- function(seq){
seq[seq=="c"] <- "g"
seq[seq=="g"] <- "c"
seq[seq=="t"] <- "a"
seq[seq=="a"] <- "t"
print(seq)
}
test2 <- create_complement(test)
test2
create_complement <- function(seq){
reverse <- 0
as.vector(reverse)
for(i in length(seq):1){ ## use x from function(x) instead of vectorname
reverse[-i+length(seq)+1] <- seq[i]
}
return(reverse)
print(reverse)
}
test2 <- create_complement(test)
test2
test
create_complement <- function(seq){
reverse <- 0
as.vector(reverse)
swap <- c(a="t", t="a", c="g", g="c")
seq_new <- swap[seq]
seq_new
for(i in length(seq_new):1){ ## use x from function(x) instead of vectorname
reverse[-i+length(seq_new)+1] <- seq_new[i]
}
return(reverse)
print(reverse)
}
test <- c("g", "a", "t", "c", "a")
test.rev <- create_complement(test)
#length(test)
test
test.rev # should be t, g, a, t, c
mito_seq_rev <- create_complement(mito_seq)
names(mito_seq_rev) <- c("x")
mito_fasta <- read.fasta('datasets/NC_012920.fasta')
# print(mito_fasta)
mito_seq <- mito_fasta$NC_012920.1
mito_seq <- as.data.frame(mito_seq)
mito_seq$x <- as.character(mito_seq$x)
head(mito_seq)
nrow(mito_seq)
mito_fasta <- read.fasta('datasets/NC_012920.fasta')
# print(mito_fasta)
mito_seq <- mito_fasta$NC_012920.1
mito_seq <- as.data.frame(mito_seq)
mito_seq$x <- as.character(mito_seq$x)
head(mito_seq)
nrow(mito_seq)
per.manual
#per.manual
nrow(mito_seq)
nucleo_content <- function(seqv) {
# Print out the relative frequencies of all nucleotids
Gsum <- sum(seqv=='g')
Csum <- sum(seqv=='c')
Asum <- sum(seqv=='a')
Tsum <- sum(seqv=='t')
cat('G : ',Gsum/nrow(seqv)*100,'%\n',sep='')
cat('C : ',Csum/nrow(seqv)*100,'%\n',sep='')
cat('A : ',Asum/nrow(seqv)*100,'%\n',sep='')
cat('T : ',Tsum/nrow(seqv)*100,'%\n',sep='')
# no return value
}
nucleo_content(mito_seq)
is.data.frame(mito_seq)
mito_seq <- as.vector(mito_seq)
is.vector(mito_seq)
length(mito_seq)
create_complement <- function(seq){
reverse <- 0
as.vector(reverse)
swap <- c(a="t", t="a", c="g", g="c")
seq_new <- swap[seq]
seq_new
for(i in length(seq_new):1){ ## use x from function(x) instead of vectorname
reverse[-i+length(seq_new)+1] <- seq_new[i]
}
return(reverse)
print(reverse)
}
test <- c("g", "a", "t", "c", "a")
test.rev <- create_complement(test)
#length(test)
test
test.rev # should be t, g, a, t, c
# => looks good :-)
mito_seq_rev <- create_complement(mito_seq)
create_complement <- function(seq){
reverse <- 0
#as.vector(reverse)
swap <- c(a="t", t="a", c="g", g="c")
seq_new <- swap[seq]
seq_new
for(i in length(seq_new):1){ ## use x from function(x) instead of vectorname
reverse[-i+length(seq_new)+1] <- seq_new[i]
}
return(reverse)
print(reverse)
}
mito_seq_rev <- create_complement(mito_seq)
is.vector(mito_seq)
create_complement <- function(seq){
reverse <- 0
as.vector(reverse)
swap <- c(a="t", t="a", c="g", g="c")
seq_new <- swap[seq]
as.vector(seq_new)
for(i in length(seq_new):1){ ## use x from function(x) instead of vectorname
reverse[-i+length(seq_new)+1] <- seq_new[i]
}
return(reverse)
print(reverse)
}
mito_seq_rev <- create_complement(mito_seq)
mito_seq_rev$x <- create_complement(mito_seq$x)
mito_seq_rev <- create_complement(mito_seq$x)
names(mito_seq_rev) <- c("x")
mito_seq_rev[1:5]
mito_seq_rev[1:5,]
mito_seq_rev$x
names(mito_seq_rev) <- c("x")
mito_seq_rev$x
create_complement <- function(seq){
reverse <- 0
#as.vector(reverse)
swap <- c(a="t", t="a", c="g", g="c")
seq_new <- swap[seq]
as.vector(seq_new)
for(i in length(seq_new):1){ ## use x from function(x) instead of vectorname
reverse[-i+length(seq_new)+1] <- seq_new[i]
}
return(reverse)
print(reverse)
}
mito_seq_rev <- create_complement(mito_seq$x)
names(mito_seq_rev) <- c("x")
mito_seq_rev$x
create_complement <- function(seq){
reverse <- 0
as.vector(reverse)
seq_new <- ifelse(seq == "a", "t",
ifelse(seq == "t", "a",
ifelse(seq == "c", "g",
ifelse(seq == "g", "c", seq))))
seq_new
for(i in length(seq_new):1){ ## use x from function(x) instead of vectorname
reverse[-i+length(seq_new)+1] <- seq_new[i]
}
return(reverse)
print(reverse)
}
test <- c("g", "a", "t", "c", "a")
test.rev <- create_complement(test)
test.rev # should be t, g, a, t, c
mito_seq_rev <- create_complement(mito_seq)
names(mito_seq_rev) <- c("x")
# Comparison
# INPUT
head(mito_seq$x, 5)
# OUTPUT
tail(mito_seq_rev$x, 5)
# OUTPUT
tail(mito_seq_rev$x, 1)
# OUTPUT
tail(mito_seq_rev$x, 2)
# Comparison
# INPUT
head(mito_seq$x, 5)
# Comparison
# INPUT
head(mito_seq$x, 5)
# OUTPUT
tail(mito_seq_rev$x, 2)
# Comparison
# INPUT
head(mito_seq$x, 5)
# OUTPUT
tail(mito_seq_rev$x, 1) # correct is: c, t,
# OUTPUT
tail(mito_seq_rev$x, 1) # correct is: c, t, a, g, t
# OUTPUT
tail(mito_seq_rev$x, 5) # correct is: c, t, a, g, t
View(mito_seq_rev)
mito_seq_rev$x[16569]
# Comparison
# INPUT
head(mito_seq$x, 1)
# OUTPUT
tail(mito_seq_rev$x, 1) # correct is: c, t, a, g, t
seq
seq <- c("g", "a", "t", "c", "a")
seq_new <- ifelse(seq == "a", "t",
ifelse(seq == "t", "a",
ifelse(seq == "c", "g",
ifelse(seq == "g", "c", seq))))
seq_new
create_complement <- function(seq){
reverse <- 0
as.vector(reverse)
for(i in length(seq_new):1){ ## use x from function(x) instead of vectorname
reverse[-i+length(seq_new)+1] <- seq_new[i]
}
reverse <-ifelse(reverse == "a", "t",
ifelse(reverse == "t", "a",
ifelse(reverse == "c", "g",
ifelse(reverse == "g", "c", reverse))))
return(reverse)
print(reverse)
}
test <- c("g", "a", "t", "c", "a")
test.rev <- create_complement(test)
test.rev # should be t, g, a, t, c
create_complement <- function(seq){
reverse <- character(length(seq)) # you MUST pre-allocate reverse
for(i in length(seq):1){ ## use x from function(x) instead of vectorname
reverse[-i+length(seq)+1] <- seq[i]
}
reverse <-ifelse(reverse == "a", "t",
ifelse(reverse == "t", "a",
ifelse(reverse == "c", "g",
ifelse(reverse == "g", "c", reverse))))
print(reverse)
return(reverse) # print must appear before return
}
create_complement <- function(seq){
reverse <- character(length(seq)) # you MUST pre-allocate reverse
for(i in length(seq):1){ ## use x from function(x) instead of vectorname
reverse[-i+length(seq)+1] <- seq[i]
}
reverse <-ifelse(reverse == "a", "t",
ifelse(reverse == "t", "a",
ifelse(reverse == "c", "g",
ifelse(reverse == "g", "c", reverse))))
print(reverse)
return(reverse) # print must appear before return
}
test <- c("g", "a", "t", "c", "a")
test.rev <- create_complement(test)
test.rev # should be t, g, a, t, c
mito_seq_rev <- create_complement(mito_seq)
names(mito_seq_rev) <- c("x")
# Comparison
# INPUT
head(mito_seq$x, 1)
# OUTPUT
tail(mito_seq_rev$x, 1) # correct is: c, t, a, g, t
# Comparison
# INPUT
head(mito_seq$x, 5)
# OUTPUT
tail(mito_seq_rev$x, 5) # correct is: c, t, a, g, t
# OUTPUT
tail(mito_seq_rev$x, 6) # correct is: c, t, a, g, t
# OUTPUT
tail(mito_seq_rev$x, 1) # correct is: c, t, a, g, t
# Comparison
# INPUT
head(mito_seq$x, 1)
# Comparison
# INPUT
head(mito_seq$x, 1)
# Comparison
# INPUT
head(mito_seq$x, 5)
create_complement <- function(seq){
create_complement <- function(seq){
reverse <- character(length(seq)) # you MUST pre-allocate reverse
for(i in length(seq):1){ ## use x from function(x) instead of vectorname
reverse[-i+length(seq)+1] <- seq[i]
}
reverse <-ifelse(reverse == "a", "t",
ifelse(reverse == "t", "a",
ifelse(reverse == "c", "g",
ifelse(reverse == "g", "c",
ifelse(reverse == "n", "n", reverse)))))
print(reverse)
return(reverse) # print must appear before return
}
test <- c("g", "a", "t", "c", "a")
test.rev <- create_complement(test)
test.rev # should be t, g, a, t, c
mito_seq_rev <- create_complement(mito_seq)
names(mito_seq_rev) <- c("x")
# Comparison
# INPUT
head(mito_seq$x, 5) # = g(first), a, t, c, a, ...
# OUTPUT
tail(mito_seq_rev$x, 5) # correct is: ..., t, g, a, t, c(last)
# Comparison
# INPUT
head(mito_seq$x, 5) # = g(first), a, t, c, a, ...
# OUTPUT
tail(mito_seq_rev$x, 5) # correct is: ..., t, g, a, t, c(last)
#| echo: false
library(seqinr)
mito_fasta <- read.fasta('datasets/NC_012920.fasta')
# print(mito_fasta)
mito_seq <- mito_fasta$NC_012920.1
mito_seq <- as.data.frame(mito_seq)
mito_seq$x <- as.character(mito_seq$x)
head(mito_seq)
nrow(mito_seq)
#per.manual
nrow(mito_seq)
nucleo_content <- function(seqv) {
# Print out the relative frequencies of all nucleotids
Gsum <- sum(seqv=='g')
Csum <- sum(seqv=='c')
Asum <- sum(seqv=='a')
Tsum <- sum(seqv=='t')
cat('G : ',Gsum/nrow(seqv)*100,'%\n',sep='')
cat('C : ',Csum/nrow(seqv)*100,'%\n',sep='')
cat('A : ',Asum/nrow(seqv)*100,'%\n',sep='')
cat('T : ',Tsum/nrow(seqv)*100,'%\n',sep='')
# no return value
}
nucleo_content(mito_seq)
is.data.frame(mito_seq)
mito_seq <- as.vector(mito_seq)
is.vector(mito_seq)
length(mito_seq)
create_complement <- function(seq){
reverse <- character(length(seq)) # you MUST pre-allocate reverse
for(i in length(seq):1){ ## use x from function(x) instead of vectorname
reverse[-i+length(seq)+1] <- seq[i]
}
reverse <-ifelse(reverse == "a", "t",
ifelse(reverse == "t", "a",
ifelse(reverse == "c", "g",
ifelse(reverse == "g", "c",
ifelse(reverse == "n", "n", reverse)))))
print(reverse)
return(reverse) # print must appear before return
}
test <- c("g", "a", "t", "c", "a")
test.rev <- create_complement(test)
test.rev # should be t, g, a, t, c
## => test output looks good :-)
mito_seq_rev <- create_complement(mito_seq)
names(mito_seq_rev) <- c("x")
# Comparison
# INPUT
head(mito_seq$x, 5) # = g(first), a, t, c, a, ...
# OUTPUT
tail(mito_seq_rev$x, 5) # correct is: ..., t, g, a, t, c(last)
## => g switched for g?!
