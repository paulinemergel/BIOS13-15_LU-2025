summary(m2)
r2
r2 <- 0.77
m2 <- lm(DevelopmentTime ~ LarvalHost * MaternalHost, data = dat)
means = tapply(dat$DevelopmentTime, list(dat$MaternalHost, dat$LarvalHost), mean)
means
labelsx <- c(unique(dat$MaternalHost), unique(dat$LarvalHost))
labelsx
plot(1:4, means, pch=16, las = 1, col = "red")
boxplot(DevelopmentTime ~ LarvalHost * MaternalHost, data = dat,
cex.axis = 0.5,
las = 1, xlab = "", ylab = "Development Time"
)
density(dat$LarvalHost)
density(dat$DevelopmentTime, dat$LarvalHost)
density(dat$DevelopmentTime)
# Kernel density plot
plot(d, lwd = 2, main = "Kernel density plot of "Development Time"")
# Kernel density plot
plot(d, lwd = 2, main = "Kernel density plot of Development Time")
# Kernel density estimation
d <- density(dat$DevelopmentTime)
# Kernel density plot
plot(d, lwd = 2, main = "Kernel density plot of Development Time")
larva <- dat %>%
select(DevelopmentTime, LarvalHost)
larva <- dat %>%
select(DevelopmentTime, LarvalHost)
libary(tidyverse)
libary(tidyverse)
install.packages("tidyverse")
libary(tidyverse)
install.packages("tidyverse")
libary(tidyverse)
install.packages("tidyverse")
libary(tidyverse)
install.packages("tidyverse")
library(tidyverse)
larva <- dat %>%
select(DevelopmentTime, LarvalHost)
print(larva)
maternal <- dat %>%
select(DevelopmentTime, MaternalHost)
larval <- dat %>%
select(DevelopmentTime, LarvalHost)
maternal <- dat %>%
select(DevelopmentTime, MaternalHost)
# Kernel density estimation
d.larval <- density(larva)
# Kernel density estimation
d.larval <- density(larval)
# Kernel density estimation
d.larval <- density(larval$DevelopmentTime)
# Kernel density plot
plot(d.larval, lwd = 2, main = "Kernel density plot of Development Time")
unique(dat$LarvalHost)
larval <- dat %>%
select(DevelopmentTime, LarvalHost == "BarbareaLH")
larval <- dat %>%
select(DevelopmentTime, LarvalHost == "BarbareaLH")
larval <- dat %>%
select(DevelopmentTime, LarvalHost) %>%
filter(LarvalHost == "BarbareaLH")
larval <- dat %>%
select(DevelopmentTime, LarvalHost) %>%
filter(LarvalHost == "BarbareaLH")
larval.Brea
larval.Brea <- dat %>%
select(DevelopmentTime, LarvalHost) %>%
filter(LarvalHost == "BarbareaLH")
larval.Brea
# Kernel density estimation
d.all <- density(dat$DevelopmentTime)
d.larval <- density(larval.Brea$DevelopmentTime)
# Kernel density plot
plot(d.all, lwd = 2, main = "Kernel density plot of Development Time (all data)")
plot(d.larval, lwd = 2, main = "Kernel density plot of Development Time (only larval plant Barbarea")
# Kernel density plot
plot(d.all, lwd = 2, main = "Kernel density plot of Development Time (all data)")
boxplot(DevelopmentTime ~ LarvalHost * MaternalHost, data = dat,
cex.axis = 0.5,
las = 1, xlab = "", ylab = "Development Time"
)
# QQplot to test for normality
plot(m2, which = 2)
hist(m2$residuals)
qqPlot(m2$residuals,
id = FALSE # remove point identification
)
# method 2
library(car)
# method 2
install.packages("car")
# method 2
# requires package "car"
qqPlot(m2$residuals,
id = FALSE # remove point identification
)
library(car)
m2 <- lm(DevelopmentTime ~ LarvalHost * MaternalHost, data = dat)
# QQplot to test for normality
# method 1
plot(m2, which = 2)
# method 2
# requires package "car"
qqPlot(m2$residuals,
id = FALSE # remove point identification
)
# Histogram
hist(m2$residuals)
## HOMOGENITY OF VARIANCES
plot(m2, which = 3)
# mean by group
aggregate(DevelopmentTime ~ LarvalHost + MaternalHost,
data = dat,
FUN = mean
)
means = tapply(dat$DevelopmentTime, list(dat$MaternalHost, dat$LarvalHost), mean)
means
means = tapply(dat$DevelopmentTime, list(dat$MaternalHost, dat$LarvalHost), mean)
means
boxplot(DevelopmentTime ~ LarvalHost * MaternalHost, data = dat,
cex.axis = 0.5,
las = 1, xlab = "", ylab = "Development Time"
)
group_by(dat, LarvalHost, MaternalHost) %>%
summarise(
mean = round(mean(DevelopmentTime, na.rm = TRUE)),
sd = round(sd(DevelopmentTime, na.rm = TRUE))
)
boxplot(DevelopmentTime ~ LarvalHost * MaternalHost, data = dat,
cex.axis = 0.5,
las = 1, xlab = "", ylab = "Development Time"
)
# ggplot2 boxplot
# boxplot by group
ggplot(dat) +
aes(x = LarvalHost, y = DevelopmentTime, fill = MaternalHost) +
geom_boxplot()
summary(m2)
## ANOVA Table
anova(m2)
## Total variance in the data
(2809.15+496.87)/(nrow(dat)-1)
var(dat$DevelopmentTime)
install.packages("ggplot2")
library(effects)
install.packages("effects")
library(effects)
plot(allEffects(m2))
library(ggpubr)
install.packages("ggpubr")
install.packages("tidyverse")
install.packages("ggplot2")
install.packages("tidyverse")
install.packages("effects")
install.packages("ggpubr")
install.packages("Rmisc")
library(tidyverse)
library(ggplot2)
library(effects)
library(ggpubr)
library(Rmisc)
# method 3
# library(ggplot, Rmisc)
with(
dat,
interaction.plot(LarvalHost, MaternalHost, DevelopmentTime)
)
dat = read.csv("datasets/butterflies.csv")
names(dat)
print(dat)
unique(dat$LarvalHost)
unique(dat$MaternalHost)
unique(dat$DevelopmentTime)
## paste0( )
## is used to concatenate (join) strings together — without any spaces between them
## it’s a simplified version of the more general paste() function.
### ONLY RUN ONCE!!!
### because it modifies (adds to) column names each time you run it
dat$MaternalHost = paste0(dat$MaternalHost, "MH")
dat$LarvalHost = paste0(dat$LarvalHost, "LH")
unique(dat$LarvalHost)
larval.Brea <- dat %>%
select(DevelopmentTime, LarvalHost) %>%
filter(LarvalHost == "BarbareaLH")
larval.Brea
# Kernel density estimation
d.all <- density(dat$DevelopmentTime)
d.larval <- density(larval.Brea$DevelopmentTime)
# Kernel density plot
plot(d.all, lwd = 2, main = "Kernel density plot of Development Time (all data)")
plot(d.larval, lwd = 2, main = "Kernel density plot of Development Time (only larval plant Barbarea")
### Do we test for NORMALITY on the raw data and/or the model??
m2 <- lm(DevelopmentTime ~ LarvalHost * MaternalHost, data = dat)
## NORMALITY
# QQplot to test for normality
# method 1
plot(m2, which = 2)
# method 2
# requires package "car"
qqPlot(m2$residuals,
id = FALSE # remove point identification
)
## Plot: larval host * maternal host effect plot
# method 1
# library(effects)
plot(allEffects(m2))
# method 3
# library(ggplot, Rmisc)
with(
dat,
interaction.plot(LarvalHost, MaternalHost, DevelopmentTime)
)
## Plot: larval host * maternal host effect plot
# method 1
# library(effects)
plot(allEffects(m2))
# method 3
# library(ggplot, Rmisc)
with(
dat,
interaction.plot(LarvalHost, MaternalHost, DevelopmentTime),
ylab = "Mean of Development Time"
)
# method 3
# library(ggplot, Rmisc)
with(
dat,
interaction.plot(LarvalHost, MaternalHost, DevelopmentTime),
labs(x = "Mean of Development Time")
)
# method 3
# library(ggplot, Rmisc)
with(
dat,
interaction.plot(LarvalHost, MaternalHost, DevelopmentTime),
labs(y = "Mean of Development Time")
)
install.packages("tidyverse")
install.packages("ggplot2")
install.packages("tidyverse")
install.packages("effects")
install.packages("ggpubr")
install.packages("Rmisc")
library(tidyverse)
library(ggplot2)
library(effects)
library(ggpubr)
library(Rmisc)
set.seed(29)
groups = as.factor(rep(c("a", "b", "c"), each=5))
y = c(rnorm(5, 10, 3), rnorm(5, 13, 3), rnorm(5, 14, 3))
means = tapply(y, groups, mean)
xvals = as.numeric(groups)+rep(seq(-.15, .15, length.out=5), 3)
par(mfrow=c(1,2), mar=c(1,1,2,1))
plot(xvals, y, las=1,
xlim=c(0.5, 3.5),
xaxt="n", xlab="",
yaxt="n", ylab="",
main="Total and among-groups SS")
abline(h=mean(y), lty=1)
segments(c(.8, 1.8, 2.8), means, c(1.2, 2.2, 3.2), lwd=2)
segments(1:3, mean(y), 1:3, means, lwd=2)
segments(xvals, mean(y), xvals, y, lty=2)
plot(xvals, y, las=1,
xlim=c(0.5, 3.5),
xaxt="n", xlab="",
yaxt="n", ylab="",
main="Within-groups SS")
segments(c(.8, 1.8, 2.8), means, c(1.2, 2.2, 3.2), lwd=2)
segments(xvals, rep(means, each=5), xvals, y, lty=2)
set.seed(100)
groups = as.factor(rep(c("Low", "Medium", "High"), each=50))
x = c(rnorm(50, 10, 3), rnorm(50, 13, 3), rnorm(50, 14, 3))
plot(groups, x, las=1, xlab="", ylab="Body size (g)")
## jitter()
par(pty = "s")  ## makes the graph SQUARE
plot(groups, x, col = 'lightgrey', pch = 1, ylab = "Body size (g)", xlab = "", )
points(groups, jitter(x, factor = 5) ,col='lightgrey')#, pch=3, cex=4) # points do not move
plot(as.numeric(groups) + rnorm(150,0,0.03), x,
las=1, xlab="", ylab="Body size (g)",
type="p", col="grey",
xlim=c(0.5, 3.75), xaxt="n", yaxt="n")
axis(1, 1:3, labels=levels(groups))
# the lines above (by themselves at least) do NOT plot anything
# WHY?
means = tapply(x, groups, mean)
points(1:3, means, pch=16, col="black")
par(new=T)
plot(groups, x, at=c(1.3, 2.3, 3.3), boxwex=0.3,
xlim=c(0.5, 3.75), xaxt="n",
las=1, xlab="", ylab="")
# at=c(1.3, 2.3, 3.3) specifies where along the x-axis each box should be placed
# boxwex = 0.3 controls the width of the boxes - the default is 0.8, so this makes the boxes narrower
# xaxt = "n" means not to draw the x-axis (the tick marks and labels)
# las controls the orientation of the axis labels: las = 1 means all labels are horizontal
## REVIEW THIS CODE
m = lm(x~groups)
anova(m)
SS_T = 319.97+1200.43
SS_T/(150-1)
var(x)
# R^2 = sum of squares of the groups/sum of squares total (groups + residuals)
319.97/SS_T
summary(m)
319.97/SS_T
groups = factor(groups, levels=c("Low", "Medium", "High"))
m = lm(x~groups)
summary(m)
m = lm(x~groups-1)
summary(m)$coef
confint(m)
dat = read.csv("datasets/butterflies.csv")
names(dat)
print(dat)
unique(dat$LarvalHost)
unique(dat$MaternalHost)
unique(dat$DevelopmentTime)
## paste0( )
## is used to concatenate (join) strings together — without any spaces between them
## it’s a simplified version of the more general paste() function.
### ONLY RUN ONCE!!!
### because it modifies (adds to) column names each time you run it
dat$MaternalHost = paste0(dat$MaternalHost, "MH")
dat$LarvalHost = paste0(dat$LarvalHost, "LH")
unique(dat$LarvalHost)
larval.Brea <- dat %>%
select(DevelopmentTime, LarvalHost) %>%
filter(LarvalHost == "BarbareaLH")
larval.Brea
# Kernel density estimation
d.all <- density(dat$DevelopmentTime)
d.larval <- density(larval.Brea$DevelopmentTime)
# Kernel density plot
plot(d.all, lwd = 2, main = "Kernel density plot of Development Time (all data)")
plot(d.larval, lwd = 2, main = "Kernel density plot of Development Time (only larval plant Barbarea")
### Do we test for NORMALITY on the raw data and/or the model??
m2 <- lm(DevelopmentTime ~ LarvalHost * MaternalHost, data = dat)
## NORMALITY
# QQplot to test for normality
# method 1
plot(m2, which = 2)
# method 2
# requires package "car"
qqPlot(m2$residuals,
id = FALSE # remove point identification
)
# method 2
# requires package "car"
qqPlot(m2$residuals,
id = FALSE # remove point identification
)
# Histogram
hist(m2$residuals)
## HOMOGENITY OF VARIANCES
plot(m2, which = 3)
## HOMOGENITY OF VARIANCES
plot(m2, which = 3)
##### [Assumptions met?]{.underline}
-   independent variables are categorical, dependent variable is continuous
-   we can assume independence within and between groups
-   normality? our data is skewed
-   BUT with a sample size of 180 per group (so \>30/group) =\> central limit theorem applies. Thus, normality assumption does not apply
-   are variances equal across groups: line is flattish, we should be OK
-   we had some, but no significant outliers in any group
# MEAN (method 1)
means = tapply(dat$DevelopmentTime, list(dat$MaternalHost, dat$LarvalHost), mean)
means
# MEAN and SD (method 2)
# library(dplyr)
group_by(dat, LarvalHost, MaternalHost) %>%
summarise(
mean = round(mean(DevelopmentTime, na.rm = TRUE)),
sd = round(sd(DevelopmentTime, na.rm = TRUE))
)
#labelsx <- c(unique(dat$MaternalHost), unique(dat$LarvalHost))
#plot(1:4, means, pch=16, las = 1, col = "red")
# Basic R boxplot
boxplot(DevelopmentTime ~ LarvalHost * MaternalHost, data = dat,
cex.axis = 0.5,
las = 1, xlab = "", ylab = "Development Time"
)
# ggplot2 boxplot
# boxplot by group
ggplot(dat) +
aes(x = LarvalHost, y = DevelopmentTime, fill = MaternalHost) +
geom_boxplot()
## ANOVA Table
anova(m2)
## Total variance in the data
(2809.15+496.87)/(nrow(dat)-1)
var(dat$DevelopmentTime)
## ANOVA Table
anova(m2)
## Total variance in the data
(2809.15+496.87)/(nrow(dat)-1)
var(dat$DevelopmentTime)
summary(m2)
r2 <- 0.77
r2
m = lm(x~groups)
anova(m)
set.seed(100)
groups = as.factor(rep(c("Low", "Medium", "High"), each=50))
x = c(rnorm(50, 10, 3), rnorm(50, 13, 3), rnorm(50, 14, 3))
plot(groups, x, las=1, xlab="", ylab="Body size (g)")
set.seed(100)
groups = as.factor(rep(c("Low", "Medium", "High"), each=50))
x = c(rnorm(50, 10, 3), rnorm(50, 13, 3), rnorm(50, 14, 3))
plot(groups, x, las=1, xlab="", ylab="Body size (g)")
plot(groups, x, las=1, xlab="", ylab="Body size (g)")
set.seed(100)
groups = as.factor(rep(c("Low", "Medium", "High"), each=50))
x = c(rnorm(50, 10, 3), rnorm(50, 13, 3), rnorm(50, 14, 3))
plot(groups, x, las=1, xlab="", ylab="Body size (g)")
x
plot(as.numeric(groups) + rnorm(150,0,0.03), x,
las=1, xlab="", ylab="Body size (g)",
type="p", col="grey",
xlim=c(0.5, 3.75), xaxt="n", yaxt="n")
axis(1, 1:3, labels=levels(groups))
# the lines above (by themselves at least) do NOT plot anything
# WHY?
means = tapply(x, groups, mean)
points(1:3, means, pch=16, col="black")
par(new=T)
plot(groups, x, at=c(1.3, 2.3, 3.3), boxwex=0.3,
xlim=c(0.5, 3.75), xaxt="n",
las=1, xlab="", ylab="")
# at=c(1.3, 2.3, 3.3) specifies where along the x-axis each box should be placed
# boxwex = 0.3 controls the width of the boxes - the default is 0.8, so this makes the boxes narrower
# xaxt = "n" means not to draw the x-axis (the tick marks and labels)
# las controls the orientation of the axis labels: las = 1 means all labels are horizontal
## REVIEW THIS CODE
means
m = lm(x~groups)
anova(m)
summary(m)
plot(as.numeric(groups) + rnorm(150,0,0.03), x,
las=1, xlab="", ylab="Body size (g)",
type="p", col="grey",
xlim=c(0.5, 3.75), xaxt="n", yaxt="n")
axis(1, 1:3, labels=levels(groups))
# the lines above (by themselves at least) do NOT plot anything
# WHY?
means = tapply(x, groups, mean)
means
points(1:3, means, pch=16, col="black")
par(new=T)
plot(groups, x, at=c(1.3, 2.3, 3.3), boxwex=0.3,
xlim=c(0.5, 3.75), xaxt="n",
las=1, xlab="", ylab="")
# at=c(1.3, 2.3, 3.3) specifies where along the x-axis each box should be placed
# boxwex = 0.3 controls the width of the boxes - the default is 0.8, so this makes the boxes narrower
# xaxt = "n" means not to draw the x-axis (the tick marks and labels)
# las controls the orientation of the axis labels: las = 1 means all labels are horizontal
## REVIEW THIS CODE
means
m = lm(x~groups)
anova(m)
summary(m)
means
means
# MEAN (method 1)
means = tapply(dat$DevelopmentTime, list(dat$MaternalHost, dat$LarvalHost), mean)
means
# MEAN and SD (method 2)
# library(dplyr)
group_by(dat, LarvalHost, MaternalHost) %>%
summarise(
mean = round(mean(DevelopmentTime, na.rm = TRUE)),
sd = round(sd(DevelopmentTime, na.rm = TRUE))
)
#labelsx <- c(unique(dat$MaternalHost), unique(dat$LarvalHost))
#plot(1:4, means, pch=16, las = 1, col = "red")
# Basic R boxplot
boxplot(DevelopmentTime ~ LarvalHost * MaternalHost, data = dat,
cex.axis = 0.5,
las = 1, xlab = "", ylab = "Development Time"
)
# ggplot2 boxplot
# boxplot by group
ggplot(dat) +
aes(x = LarvalHost, y = DevelopmentTime, fill = MaternalHost) +
geom_boxplot()
## Plot: larval host * maternal host effect plot
# see: https://statsandr.com/blog/two-way-anova-in-r/
# method 1
# library(effects)
plot(allEffects(m2))
# method 2
# libaryr = ?
with(
dat,
interaction.plot(LarvalHost, MaternalHost, DevelopmentTime),
)
# method 3
# library(Rmisc)
# compute mean and standard error of the mean by subgroup
summary_stat <- summarySE(dat,
measurevar = "body_mass_g",
groupvars = c("species", "sex")
)
aov(m2)
## group means
model.tables(aov(m2), type = "means")
## estimates
summary(m2)
## group means
model.tables(aov(m2), type = "means")
## r2
